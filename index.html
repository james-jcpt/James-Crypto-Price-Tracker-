<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>JCI Platform</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="styles.css">
</head>
<body>

<h1>JCI Platform</h1>

<section id="auth">
  <input id="email" placeholder="Email">
  <input id="password" type="password" placeholder="Password">
  <button id="signup">Sign Up</button>
  <button id="login">Login</button>
  <p id="auth-status"></p>
</section>

<input id="coin-search" placeholder="Search coin">

<h2>Coins</h2>
<div id="coin-list"></div>

<h2>Watchlist</h2>
<div id="watchlist"></div>

<h2>Charts (1s update)</h2>
<canvas id="chart"></canvas>

<h3>Status</h3>
<div id="vip-status"></div>

<h3>Leaderboard</h3>
<div id="leaderboard"></div>

<h3>Live Crypto News</h3>
<div id="news"></div>

<button id="premium-btn">Upgrade Premium</button>

<!-- FIREBASE -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.6.1/firebase-app.js";
import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.6.1/firebase-auth.js";
import { getFirestore, doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/10.6.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "YOUR_KEY",
  authDomain: "YOUR_DOMAIN",
  projectId: "YOUR_PROJECT_ID",
  storageBucket: "YOUR_BUCKET",
  messagingSenderId: "YOUR_SENDER",
  appId: "YOUR_APP_ID"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

window.db = db;
window.auth = auth;
window.currentUser = null;

signup.onclick = async () => {
  const cred = await createUserWithEmailAndPassword(auth, email.value, password.value);
  await setDoc(doc(db, "users", cred.user.uid), {
    watchlist: [],
    points: 0,
    tier: "PREMIUM",
    premiumUntil: Date.now() + 2592000000
  });
};

login.onclick = async () => {
  const cred = await signInWithEmailAndPassword(auth, email.value, password.value);
  loadUser(cred.user.uid);
};

onAuthStateChanged(auth, user => {
  if (user) {
    window.currentUser = user;
    loadUser(user.uid);
  }
});

async function loadUser(uid) {
  const snap = await getDoc(doc(db, "users", uid));
  const d = snap.data();
  localStorage.setItem("watchlist", JSON.stringify(d.watchlist));
  localStorage.setItem("points", d.points);
  localStorage.setItem("tier", d.tier);
}
</script>

<script type="module" src="coins.js"></script>
<script type="module" src="coin-select.js"></script>
<script type="module" src="watchlist.js"></script>
<script type="module" src="charts.js"></script>
<script type="module" src="ai-engine.js"></script>
<script type="module" src="gamification.js"></script>
<script type="module" src="leaderboard.js"></script>
<script type="module" src="premium.js"></script>
<script type="module" src="news.js"></script>

</body>
  </html>
